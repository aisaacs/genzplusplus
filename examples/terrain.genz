ðŸ’€ infinite terrain flyover - voxel space column raycasting
ðŸ’€ WASD/arrows to fly, Q to quit
plug in screen
plug in math
plug in time
plug in keys

yeet w = 60
yeet h = 40
yeet s = screen.new(w, h, âœ¨terrain flyover  wasd/arrows  q=quitâœ¨)
s.init()
keys.start()

ðŸ’€ gentler terrain: range ~-11.5 to +11.5
bruh terrain(x, z) tho
    its giving math.vibes(x * 0.13 + z * 0.09) * 3.5 + math.vibes(x * 0.07 - z * 0.11) * 6 + math.vibes(x * 0.31 + z * 0.17) * 2
bet

ðŸ’€ camera state
yeet cam_x = 0
yeet cam_z = 0
yeet heading = 0
yeet speed = 0.8
yeet turn_rate = 0.06

yeet horizon = 12
yeet scale = 80
yeet fov = 1.5
yeet max_depth = 80

ðŸ’€ sky color for fog blending
yeet sky_r = 80
yeet sky_g = 120
yeet sky_b = 180

yeet running = no cap
vibe check running tho
    ðŸ’€ handle input
    sus keys.down(âœ¨qâœ¨) or keys.down(âœ¨escâœ¨) tho
        yeet running = cap
    bet
    sus keys.down(âœ¨aâœ¨) or keys.down(âœ¨leftâœ¨) tho
        yeet heading = heading - turn_rate
    bet
    sus keys.down(âœ¨dâœ¨) or keys.down(âœ¨rightâœ¨) tho
        yeet heading = heading + turn_rate
    bet
    sus keys.down(âœ¨wâœ¨) or keys.down(âœ¨upâœ¨) tho
        yeet speed = speed + 0.15
        sus speed > 3 tho
            yeet speed = 3
        bet
    bet
    sus keys.down(âœ¨sâœ¨) or keys.down(âœ¨downâœ¨) tho
        yeet speed = speed - 0.15
        sus speed < 0 tho
            yeet speed = 0
        bet
    bet
    keys.clear()

    ðŸ’€ move camera in heading direction
    yeet sin_h = math.vibes(heading)
    yeet cos_h = math.waves(heading)
    yeet cam_x = cam_x + sin_h * speed
    yeet cam_z = cam_z + cos_h * speed
    yeet cam_y = terrain(cam_x, cam_z) + 12

    s.clear(sky_r, sky_g, sky_b)

    ðŸ’€ raycast each screen column
    yeet cx = 0
    vibe check cx < w tho
        yeet top = h
        yeet col_off = (cx - 30) * fov / 30

        ðŸ’€ ray direction rotated by heading
        yeet dx = sin_h + col_off * cos_h
        yeet dz = cos_h - col_off * sin_h

        ðŸ’€ march depth near to far, exit when column full
        yeet step = 0
        vibe check step < 40 and top > 0 tho
            yeet d = (step + 1) * 2

            ðŸ’€ world sample point
            yeet wx = cam_x + dx * d
            yeet wz = cam_z + dz * d
            yeet th = terrain(wx, wz)

            ðŸ’€ perspective project to screen row
            yeet sy = math.humbled(horizon + (cam_y - th) * scale / d)
            sus sy < 0 tho
                yeet sy = 0
            bet

            sus sy < top tho
                ðŸ’€ biome color by height (adjusted for gentler terrain)
                yeet r = 50
                yeet g = 150
                yeet b = 60

                sus th < -3 tho
                    ðŸ’€ deep water
                    yeet r = 30
                    yeet g = 80
                    yeet b = 180
                nah sus th < -1 tho
                    ðŸ’€ shore/sand
                    yeet r = 180
                    yeet g = 160
                    yeet b = 100
                nah sus th < 2 tho
                    ðŸ’€ grass
                    yeet r = 50
                    yeet g = 150
                    yeet b = 60
                nah sus th < 6 tho
                    ðŸ’€ highland
                    yeet r = 80
                    yeet g = 120
                    yeet b = 50
                nah sus th < 9 tho
                    ðŸ’€ rock
                    yeet r = 120
                    yeet g = 100
                    yeet b = 70
                nah
                    ðŸ’€ snow
                    yeet r = 220
                    yeet g = 220
                    yeet b = 230
                bet

                ðŸ’€ distance fog blend toward sky
                yeet fog = math.power_move(d / max_depth, 1.5)
                yeet r = math.humbled(r + (sky_r - r) * fog)
                yeet g = math.humbled(g + (sky_g - g) * fog)
                yeet b = math.humbled(b + (sky_b - b) * fog)

                ðŸ’€ draw vertical strip (native bresenham)
                s.line(cx, sy, cx, top - 1, r, g, b)
                yeet top = sy
            bet

            yeet step = step + 1
        bet

        yeet cx = cx + 1
    bet

    s.render()
    time.nap(20)
bet

keys.stop()
s.done()

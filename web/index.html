<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>genz++ playground</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
      background: #0f0f1a;
      color: #e0e0e0;
      min-height: 100vh;
    }
    .header {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border-bottom: 2px solid #ff6b9d;
      padding: 16px 24px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .header h1 {
      font-size: 24px;
      background: linear-gradient(90deg, #ff6b9d, #c084fc, #67e8f9);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .header .sub {
      color: #888;
      font-size: 13px;
    }
    .toolbar {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 24px;
      background: #12121f;
      border-bottom: 1px solid #2a2a3e;
    }
    .btn {
      background: #ff6b9d;
      color: #fff;
      border: none;
      padding: 8px 20px;
      border-radius: 8px;
      font-family: inherit;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
    }
    .btn:hover { background: #ff85b1; transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }
    .btn.stop {
      background: #ef4444;
    }
    .btn.stop:hover { background: #f87171; }
    .btn:disabled {
      background: #555;
      cursor: not-allowed;
      transform: none;
    }
    select {
      background: #1a1a2e;
      color: #e0e0e0;
      border: 1px solid #2a2a3e;
      padding: 8px 12px;
      border-radius: 8px;
      font-family: inherit;
      font-size: 13px;
      cursor: pointer;
    }
    select:focus { outline: none; border-color: #ff6b9d; }
    .main {
      display: flex;
      height: calc(100vh - 110px);
    }
    .editor-pane {
      flex: 1;
      display: flex;
      flex-direction: column;
      border-right: 1px solid #2a2a3e;
      min-width: 0;
    }
    .editor-label {
      padding: 8px 16px;
      font-size: 12px;
      color: #666;
      background: #12121f;
      border-bottom: 1px solid #1a1a2e;
    }
    #editor {
      flex: 1;
      background: #0a0a14;
      color: #e0e0e0;
      border: none;
      padding: 16px;
      font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
      font-size: 14px;
      line-height: 1.6;
      resize: none;
      outline: none;
      tab-size: 4;
    }
    #editor::placeholder { color: #444; }
    .output-pane {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }
    .output-label {
      padding: 8px 16px;
      font-size: 12px;
      color: #666;
      background: #12121f;
      border-bottom: 1px solid #1a1a2e;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .clear-btn {
      background: none;
      border: none;
      color: #666;
      cursor: pointer;
      font-family: inherit;
      font-size: 12px;
    }
    .clear-btn:hover { color: #ff6b9d; }
    #genz-output {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      background: #0a0a14;
    }
    #genz-output .genz-line {
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-size: 14px;
      line-height: 1.5;
      color: #c084fc;
      white-space: pre-wrap;
      word-break: break-all;
    }
    #genz-output .genz-error {
      color: #ef4444;
      font-weight: 600;
    }
    #genz-output canvas {
      max-width: 100%;
      height: auto;
    }
    .status {
      font-size: 13px;
      color: #666;
      padding: 0 8px;
    }
    .status.running { color: #67e8f9; }
    .status.error { color: #ef4444; }
    .status.done { color: #4ade80; }

    /* Responsive */
    @media (max-width: 768px) {
      .header { padding: 10px 12px; gap: 8px; }
      .header h1 { font-size: 20px; }
      .header .sub { display: none; }
      .toolbar { padding: 8px 12px; gap: 8px; flex-wrap: wrap; }
      .btn { padding: 6px 14px; font-size: 13px; }
      select { font-size: 12px; padding: 6px 8px; }
      .main { flex-direction: column; height: auto; min-height: calc(100vh - 90px); }
      .editor-pane { border-right: none; border-bottom: 1px solid #2a2a3e; flex: none; height: 35vh; min-height: 150px; }
      .output-pane { flex: 1; min-height: 40vh; }
      #editor { font-size: 13px; padding: 10px; }
      #genz-output { padding: 10px; }
      #genz-output canvas { max-width: 100%; height: auto; }
    }

    /* Touch gamepad â€” injected by GPU module on touch devices */
    .genz-gamepad {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      gap: 8px;
      user-select: none;
      -webkit-user-select: none;
      touch-action: none;
    }
    .genz-dpad {
      display: grid;
      grid-template-columns: 48px 48px 48px;
      grid-template-rows: 48px 48px;
      gap: 4px;
    }
    .genz-dpad-btn {
      width: 48px;
      height: 48px;
      border-radius: 10px;
      border: 2px solid #ff6b9d;
      background: rgba(255,107,157,0.15);
      color: #ff6b9d;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      touch-action: none;
    }
    .genz-dpad-btn:active, .genz-dpad-btn.active {
      background: rgba(255,107,157,0.5);
    }
    .genz-dpad-btn.empty {
      border: none;
      background: none;
    }
    .genz-action-btns {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center;
    }
    .genz-action-btn {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      border: 2px solid #67e8f9;
      background: rgba(103,232,249,0.15);
      color: #67e8f9;
      font-family: monospace;
      font-size: 11px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      touch-action: none;
    }
    .genz-action-btn:active, .genz-action-btn.active {
      background: rgba(103,232,249,0.5);
    }
    .genz-meta-btns {
      display: flex;
      gap: 6px;
      justify-content: center;
    }
    .genz-meta-btn {
      padding: 6px 14px;
      border-radius: 6px;
      border: 1px solid #666;
      background: rgba(100,100,100,0.2);
      color: #999;
      font-family: monospace;
      font-size: 11px;
      cursor: pointer;
      touch-action: none;
    }
    .genz-meta-btn:active, .genz-meta-btn.active {
      background: rgba(100,100,100,0.5);
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>genz++</h1>
    <span class="sub">the future of code. in your browser. no cap.</span>
  </div>
  <div class="toolbar">
    <button class="btn" id="run-btn" onclick="runCode()">run it</button>
    <button class="btn stop" id="stop-btn" onclick="stopCode()" disabled>stop</button>
    <select id="examples" onchange="loadExample()">
      <option value="">-- examples --</option>
      <option value="hello">hello world</option>
      <option value="fizzbuzz">fizzbuzz</option>
      <option value="fibonacci">fibonacci</option>
      <option value="plasma">gpu plasma</option>
      <option value="toccata">toccata & fugue</option>
      <option value="asteroids">asteroids</option>
      <option value="dom_hello">dom: hello</option>
      <option value="dom_counter">dom: counter</option>
    </select>
    <span class="status" id="status"></span>
  </div>
  <div class="main">
    <div class="editor-pane">
      <div class="editor-label">editor</div>
      <textarea id="editor" spellcheck="false" placeholder="write your genz++ code here bestie..."></textarea>
    </div>
    <div class="output-pane">
      <div class="output-label">
        <span>output</span>
        <button class="clear-btn" onclick="clearOutput()">clear</button>
      </div>
      <div id="genz-output"></div>
      <div id="genz-gpu"></div>
      <div id="genz-dom"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- EXAMPLES as <script type="text/genz"> â€” not auto-executed,    -->
  <!-- just stored in the DOM for the playground to pull from.        -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <script type="text/genz" id="example-hello">
ğŸ’€ hello world - the simplest genz++ program no cap

spill âœ¨hello worldâœ¨
spill âœ¨this is genz++ running in your browserâœ¨
spill âœ¨and its giving everythingâœ¨
  </script>

  <script type="text/genz" id="example-fizzbuzz">
ğŸ’€ fizzbuzz but make it genz++
ğŸ’€ the classic coding interview question

yeet i = 1

vibe check i <= 30 tho
    sus i % 15 be 0 tho
        spill âœ¨âœ¨ + i + âœ¨: FizzBuzz slay ğŸ’…âœ¨
    nah sus i % 3 be 0 tho
        spill âœ¨âœ¨ + i + âœ¨: Fizz no capâœ¨
    nah sus i % 5 be 0 tho
        spill âœ¨âœ¨ + i + âœ¨: Buzz fr frâœ¨
    nah
        spill i
    bet
    yeet i = i + 1
bet
  </script>

  <script type="text/genz" id="example-fibonacci">
ğŸ’€ fibonacci - the golden ratio coded up

bruh fib(n) tho
    sus n <= 1 tho
        its giving n
    bet
    its giving fib(n - 1) + fib(n - 2)
bet

yeet i = 0
vibe check i <= 15 tho
    spill âœ¨fib(âœ¨ + i + âœ¨) = âœ¨ + fib(i)
    yeet i = i + 1
bet
  </script>

  <script type="text/genz" id="example-plasma">
ğŸ’€ GPU PLASMA â€” demoscene vibes in your browser
ğŸ’€ ESC to quit

plug in gpu
plug in math

yeet W = 320
yeet H = 200
yeet w = gpu.spawn(W, H, âœ¨genz++ gpu plasmaâœ¨)

ğŸ’€ logic resolution â€” 1/4 of window, each pixel is a 4x4 block
yeet PX = 4
yeet LW = W / PX
yeet LH = H / PX

yeet t = 0

vibe check w.serve() tho
    sus w.pressed(âœ¨escâœ¨) tho
        dip
    bet

    yeet y = 0
    vibe check y < LH tho
        yeet x = 0
        vibe check x < LW tho
            ğŸ’€ classic plasma: sum of sines
            yeet v1 = math.vibes(x * 0.08 + t * 0.07)
            yeet v2 = math.vibes(y * 0.1 + t * 0.05)
            yeet v3 = math.vibes((x + y) * 0.06 + t * 0.04)
            yeet v4 = math.vibes(math.glow(x * x + y * y) * 0.05 + t * 0.03)

            yeet val = (v1 + v2 + v3 + v4) * 0.25

            ğŸ’€ map to RGB
            yeet r = math.humbled(math.ate(math.vibes(val * 3.14159 + t * 0.02)) * 255)
            yeet g = math.humbled(math.ate(math.vibes(val * 3.14159 + 2.094 + t * 0.03)) * 255)
            yeet b = math.humbled(math.ate(math.vibes(val * 3.14159 + 4.188 + t * 0.015)) * 255)

            w.drip(x * PX, y * PX, PX, PX, r, g, b)
            yeet x = x + 1
        bet
        yeet y = y + 1
    bet

    ğŸ’€ title overlay
    w.stan(âœ¨PLASMAâœ¨, 10, 10, 255, 255, 255, 2)
    w.stan(âœ¨ESC=QUITâœ¨, 10, H - 20, 120, 120, 140)

    w.flaunt()
    yeet t = t + 1
bet

w.unalive()
spill âœ¨âœ¨
spill âœ¨ğŸ’€ plasma complete. the demoscene lives in genz++ now.âœ¨
  </script>

  <script type="text/genz" id="example-dom_hello">
ğŸ’€ DOM module demo â€” create elements in the browser

plug in dom

ğŸ’€ inject some styles
dom.vibes(âœ¨
  #genz-dom {
    padding: 24px;
    font-family: system-ui, sans-serif;
  }
  .hero {
    background: linear-gradient(135deg, #1a1a2e, #16213e);
    padding: 32px;
    border-radius: 16px;
    border: 2px solid #ff6b9d;
    text-align: center;
  }
  .hero h1 {
    font-size: 36px;
    background: linear-gradient(90deg, #ff6b9d, #c084fc, #67e8f9);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 12px;
  }
  .hero p { color: #aaa; font-size: 16px; }
âœ¨)

ğŸ’€ build the DOM
yeet hero = dom.cook(âœ¨divâœ¨)
dom.glow_up(hero, âœ¨heroâœ¨)

yeet title = dom.cook(âœ¨h1âœ¨)
dom.caption(title, âœ¨hello from genz++âœ¨)
dom.yeet_in(hero, title)

yeet desc = dom.cook(âœ¨pâœ¨)
dom.caption(desc, âœ¨this was built entirely with the dom module. no cap.âœ¨)
dom.yeet_in(hero, desc)

dom.yeet(hero)

spill âœ¨DOM elements created!âœ¨
  </script>

  <script type="text/genz" id="example-dom_counter">
ğŸ’€ DOM counter â€” interactive button with callbacks

plug in dom

dom.vibes(âœ¨
  #genz-dom {
    padding: 24px;
    font-family: system-ui, sans-serif;
  }
  .counter-box {
    background: #1a1a2e;
    border: 2px solid #c084fc;
    border-radius: 16px;
    padding: 32px;
    text-align: center;
    max-width: 300px;
  }
  .count {
    font-size: 64px;
    color: #c084fc;
    font-weight: bold;
    margin: 16px 0;
  }
  .counter-btn {
    background: #c084fc;
    color: #fff;
    border: none;
    padding: 12px 32px;
    border-radius: 8px;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    margin: 4px;
    transition: all 0.15s;
  }
  .counter-btn:hover {
    background: #d4a0ff;
    transform: translateY(-2px);
  }
âœ¨)

yeet count = 0
yeet box = dom.cook(âœ¨divâœ¨)
dom.glow_up(box, âœ¨counter-boxâœ¨)

yeet label = dom.cook(âœ¨divâœ¨)
dom.caption(label, âœ¨click counterâœ¨)
dom.drip(label, âœ¨colorâœ¨, âœ¨#888âœ¨)
dom.drip(label, âœ¨fontSizeâœ¨, âœ¨14pxâœ¨)
dom.yeet_in(box, label)

yeet display = dom.cook(âœ¨divâœ¨)
dom.glow_up(display, âœ¨countâœ¨)
dom.caption(display, âœ¨0âœ¨)
dom.yeet_in(box, display)

bruh increment(ev) tho
    yeet count = count + 1
    dom.caption(display, âœ¨âœ¨ + count)
bet

bruh decrement(ev) tho
    yeet count = count - 1
    dom.caption(display, âœ¨âœ¨ + count)
bet

yeet minus_btn = dom.cook(âœ¨buttonâœ¨)
dom.glow_up(minus_btn, âœ¨counter-btnâœ¨)
dom.caption(minus_btn, âœ¨-âœ¨)
dom.tune_in(minus_btn, âœ¨clickâœ¨, decrement)
dom.yeet_in(box, minus_btn)

yeet plus_btn = dom.cook(âœ¨buttonâœ¨)
dom.glow_up(plus_btn, âœ¨counter-btnâœ¨)
dom.caption(plus_btn, âœ¨+âœ¨)
dom.tune_in(plus_btn, âœ¨clickâœ¨, increment)
dom.yeet_in(box, plus_btn)

dom.yeet(box)

spill âœ¨counter ready! click the buttons.âœ¨
  </script>

  <script type="text/genz" id="example-toccata">
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ TOCCATA & FUGUE IN D MINOR â€” Bach x Cyberpunk
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ procedural plasma + procedural audio synthesis demoscene
ğŸ’€ every pixel computed, every note synthesized, zero files loaded
ğŸ’€ ESC to quit
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

plug in gpu
plug in math
plug in sound
plug in time

yeet W = 200
yeet H = 100
yeet w = gpu.spawn(W, H, âœ¨TOCCATA â€” genz++âœ¨)
yeet snd = sound.spawn()
snd.volume(80)

ğŸ’€ plasma resolution â€” 4x4 fat pixels
yeet PX = 4
yeet LW = W / PX
yeet LH = H / PX

ğŸ’€ music energy â€” drives visual reactivity
yeet energy = 0
yeet bass_e = 0
yeet pt = 0
yeet t = 0
yeet LOOP = 1500

ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ SOUND HELPERS
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’€ organ â€” stacks octaves like a pipe organ with multiple stops
bruh organ(of, od, ov) tho
    snd.bop(âœ¨sawâœ¨, of, od, ov)
    snd.bop(âœ¨sawâœ¨, of * 2, od, ov * 0.6)
    snd.bop(âœ¨squareâœ¨, of, od, ov * 0.3)
    yeet energy = 1
bet

ğŸ’€ lead â€” saw + square doubling for the runs
bruh lead(lf, ld, lv) tho
    snd.bop(âœ¨sawâœ¨, lf, ld, lv)
    snd.bop(âœ¨squareâœ¨, lf, ld, lv * 0.25)
    yeet energy = 0.8
bet

bruh bass_note(nf, nd, nv) tho
    snd.bop(âœ¨squareâœ¨, nf, nd, nv)
    snd.bop(âœ¨sineâœ¨, nf, nd, nv * 0.5)
    yeet bass_e = 1
bet

ğŸ’€ heavy kick â€” sub-bass thump + transient
bruh kick() tho
    snd.noise(80, 65)
    snd.bop(âœ¨sineâœ¨, 50, 150, 60)
    snd.bop(âœ¨sineâœ¨, 30, 100, 45)
    yeet bass_e = 1
bet

ğŸ’€ snare â€” noise crack + mid tone
bruh snare() tho
    snd.noise(180, 55)
    snd.bop(âœ¨triâœ¨, 200, 60, 30)
    yeet energy = 0.7
bet

bruh hat() tho
    snd.noise(30, 25)
bet

bruh open_hat() tho
    snd.noise(80, 30)
bet

ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ MAIN LOOP
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

vibe check w.serve() tho
    yeet frame_start = time.rn()

    sus w.pressed(âœ¨escâœ¨) tho
        dip
    bet

    snd.serve()

    ğŸ’€ decay music energy each frame
    yeet energy = energy * 0.93
    yeet bass_e = bass_e * 0.91

    ğŸ’€ plasma time â€” speeds up on note hits
    yeet pt = pt + 0.07 + energy * 0.05

    yeet f = t % LOOP

    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ğŸ’€ TOCCATA â€” rubato opening
    ğŸ’€ dramatic pauses, accelerating runs
    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    ğŸ’€ sub-bass rumble buildup
    sus f be 5 tho
        snd.slide(âœ¨sineâœ¨, 40, 500, 800, 30)
    bet

    ğŸ’€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ğŸ’€ FIRST PHRASE â€” high octave
    ğŸ’€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    ğŸ’€ mordent: D5-C#5-D5 (lightning fast)
    sus f be 30 tho
        lead(587, 35, 75)
    bet
    sus f be 32 tho
        lead(554, 35, 70)
    bet
    ğŸ’€ held D5 â€” fermata with organ fullness
    sus f be 34 tho
        organ(587, 900, 75)
    bet

    ğŸ’€ descending run: A4-G4-F4-E4-D4-C#4-D4
    ğŸ’€ ACCELERATING â€” gaps decrease: 11, 10, 9, 8, 6, 5
    sus f be 100 tho
        lead(440, 170, 70)
    bet
    sus f be 111 tho
        lead(392, 155, 70)
    bet
    sus f be 121 tho
        lead(349, 140, 70)
    bet
    sus f be 130 tho
        lead(330, 125, 70)
    bet
    sus f be 138 tho
        lead(294, 100, 70)
    bet
    sus f be 144 tho
        lead(277, 80, 65)
    bet
    ğŸ’€ resolve on D4 â€” fermata
    sus f be 149 tho
        organ(294, 1000, 75)
        bass_note(147, 1000, 35)
    bet

    ğŸ’€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ğŸ’€ SECOND PHRASE â€” one octave lower
    ğŸ’€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    ğŸ’€ mordent: D4-C#4-D4
    sus f be 240 tho
        lead(294, 35, 75)
    bet
    sus f be 242 tho
        lead(277, 35, 70)
    bet
    ğŸ’€ held D4 â€” fermata
    sus f be 244 tho
        organ(294, 900, 75)
    bet

    ğŸ’€ descending run: A3-G3-F3-E3-D3-C#3-D3
    sus f be 310 tho
        lead(220, 170, 70)
    bet
    sus f be 321 tho
        lead(196, 155, 70)
    bet
    sus f be 331 tho
        lead(175, 140, 70)
    bet
    sus f be 340 tho
        lead(165, 125, 70)
    bet
    sus f be 348 tho
        lead(147, 100, 70)
    bet
    sus f be 354 tho
        lead(139, 80, 65)
    bet
    ğŸ’€ resolve on D3 â€” long fermata
    sus f be 359 tho
        organ(147, 1300, 75)
        bass_note(73, 1300, 50)
    bet

    ğŸ’€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ğŸ’€ TENSION â€” diminished approach
    ğŸ’€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    sus f be 460 tho
        snd.slide(âœ¨sawâœ¨, 1000, 60, 800, 35)
        snd.slide(âœ¨sineâœ¨, 50, 500, 700, 30)
    bet
    sus f be 490 tho
        snd.noise(300, 40)
    bet

    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ğŸ’€ THE CHORD â€” D minor, every stop pulled
    ğŸ’€ 12 voices: sub-bass through mixture
    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    sus f be 520 tho
        ğŸ’€ sub-bass foundation
        snd.bop(âœ¨sineâœ¨, 36, 3500, 55)
        snd.bop(âœ¨sineâœ¨, 73, 3500, 55)

        ğŸ’€ bass organ â€” saw + square
        snd.bop(âœ¨sawâœ¨, 147, 3500, 50)
        snd.bop(âœ¨squareâœ¨, 147, 3500, 30)

        ğŸ’€ principal â€” the core of the organ
        snd.bop(âœ¨sawâœ¨, 220, 3500, 45)
        snd.bop(âœ¨sawâœ¨, 294, 3500, 50)
        snd.bop(âœ¨sawâœ¨, 349, 3500, 45)

        ğŸ’€ octave stop â€” brilliance
        snd.bop(âœ¨sawâœ¨, 440, 3000, 40)
        snd.bop(âœ¨sawâœ¨, 587, 3000, 35)

        ğŸ’€ mixture â€” shimmer
        snd.bop(âœ¨squareâœ¨, 294, 3000, 25)
        snd.bop(âœ¨squareâœ¨, 440, 2500, 20)

        ğŸ’€ crash impact
        snd.noise(600, 60)

        yeet energy = 1
        yeet bass_e = 1
    bet

    ğŸ’€ reverb tail
    sus f be 523 tho
        snd.noise(200, 40)
    bet
    sus f be 530 tho
        snd.slide(âœ¨sineâœ¨, 80, 2500, 1200, 20)
    bet

    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ğŸ’€ BEAT DROP â€” cyberpunk kicks in
    ğŸ’€ 120 BPM = 30 frames per beat
    ğŸ’€ bar = 120 frames
    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    sus f >= 750 tho
        ğŸ’€ crash cymbal on the drop
        sus f be 750 tho
            snd.noise(500, 60)
        bet

        ğŸ’€ â”€â”€ drums: kick + snare + hats â”€â”€
        yeet bf = (f - 750) % 120

        ğŸ’€ four-on-the-floor kick
        sus bf be 0 tho
            kick()
        bet
        sus bf be 30 tho
            kick()
        bet
        sus bf be 60 tho
            kick()
        bet
        sus bf be 90 tho
            kick()
        bet

        ğŸ’€ snare on 2 and 4
        sus bf be 30 tho
            snare()
        bet
        sus bf be 90 tho
            snare()
        bet

        ğŸ’€ hi-hats on 8th notes â€” closed on beat, open offbeat
        sus bf be 0 tho
            hat()
        bet
        sus bf be 15 tho
            open_hat()
        bet
        sus bf be 30 tho
            hat()
        bet
        sus bf be 45 tho
            open_hat()
        bet
        sus bf be 60 tho
            hat()
        bet
        sus bf be 75 tho
            open_hat()
        bet
        sus bf be 90 tho
            hat()
        bet
        sus bf be 105 tho
            open_hat()
        bet

        ğŸ’€ â”€â”€ bass: D2 and A2 alternating every half-bar â”€â”€
        yeet bb = (f - 750) % 120
        sus bb be 0 tho
            bass_note(73, 400, 55)
        bet
        sus bb be 60 tho
            bass_note(110, 400, 50)
        bet

        ğŸ’€ â”€â”€ fugue subject on organ lead â”€â”€
        yeet mf = (f - 750) % 240
        sus mf be 0 tho
            organ(294, 200, 55)
        bet
        sus mf be 30 tho
            organ(440, 200, 55)
        bet
        sus mf be 60 tho
            lead(587, 130, 60)
        bet
        sus mf be 75 tho
            lead(554, 80, 55)
        bet
        sus mf be 90 tho
            organ(587, 280, 65)
        bet
        sus mf be 120 tho
            organ(349, 200, 55)
        bet
        sus mf be 150 tho
            organ(330, 200, 55)
        bet
        sus mf be 180 tho
            lead(294, 130, 60)
        bet
        sus mf be 195 tho
            lead(277, 80, 55)
        bet
        sus mf be 210 tho
            organ(294, 280, 65)
        bet
    bet

    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ğŸ’€ PLASMA â€” cyberpunk palette
    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    yeet y = 0
    vibe check y < LH tho
        yeet x = 0
        vibe check x < LW tho
            ğŸ’€ four overlapping sines â€” classic plasma
            yeet v1 = math.vibes(x * 0.08 + pt)
            yeet v2 = math.vibes(y * 0.1 + pt * 0.7)
            yeet v3 = math.vibes((x + y) * 0.06 + pt * 0.6)
            yeet v4 = math.vibes(math.glow(x * x + y * y) * 0.04 + pt * 0.5)
            yeet val = (v1 + v2 + v3 + v4) * 0.25

            ğŸ’€ cyberpunk color mapping: purple â†’ magenta â†’ cyan
            yeet phase = val * 3.14159 + pt * 0.3
            yeet pr = math.ate(math.vibes(phase))
            yeet pg = math.ate(math.vibes(phase + 4.2))
            yeet pb = math.ate(math.vibes(phase + 2.1))

            ğŸ’€ R: magenta/red â€” squared for high contrast
            ğŸ’€ G: subdued, flares on melody hits
            ğŸ’€ B: dominant cyan/purple base
            yeet flash = bass_e * 80
            yeet r = math.humbled(pr * pr * 220 + flash)
            yeet g = math.humbled(pg * 50 + energy * 100)
            yeet b = math.humbled(pb * 255)

            sus r > 255 tho
                yeet r = 255
            bet
            sus g > 255 tho
                yeet g = 255
            bet

            ğŸ’€ scanline darkening â€” every other row
            sus y % 2 be 0 tho
                yeet r = math.humbled(r * 0.7)
                yeet g = math.humbled(g * 0.7)
                yeet b = math.humbled(b * 0.7)
            bet

            w.drip(x * PX, y * PX, PX, PX, r, g, b)
            yeet x = x + 1
        bet
        yeet y = y + 1
    bet

    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ğŸ’€ TITLE OVERLAY
    ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    yeet tr = 200 + math.humbled(bass_e * 55)
    yeet tg = 140 + math.humbled(energy * 80)
    yeet tb = 220 + math.humbled(bass_e * 35)

    sus f < 520 tho
        w.stan(âœ¨TOCCATA & FUGUEâœ¨, 262, 16, tr, tg, tb, 3)
        w.stan(âœ¨IN D MINORâœ¨, 333, 52, 160, 100, 180, 2)
    nah
        w.stan(âœ¨TOCCATAâœ¨, 330, 16, tr, tg, tb, 3)
    bet
    w.stan(âœ¨BWV 565 x CYBERPUNKâœ¨, 291, H - 38, 100, 70, 140, 2)
    w.stan(âœ¨genz++âœ¨, 375, H - 18, 70, 50, 90)

    w.flaunt()

    ğŸ’€ cap at 60fps so music plays at correct tempo
    yeet frame_ms = time.rn() - frame_start
    sus frame_ms < 16 tho
        time.nap(16 - frame_ms)
    bet

    yeet t = t + 1
bet

snd.unalive()
w.unalive()
spill âœ¨âœ¨
spill âœ¨ğŸ’€ toccata complete. bach has been cyberpunked.âœ¨
  </script>

  <script type="text/genz" id="example-asteroids">
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ ASTEROIDS â€” classic vector-style arcade game
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ arrows/WASD to move, space to shoot, ESC to quit
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

plug in gpu
plug in math
plug in random
plug in list
plug in sound

ğŸ’€ â”€â”€ window â”€â”€
yeet W = 800
yeet H = 600
yeet w = gpu.spawn(W, H, âœ¨genz++ ASTEROIDSâœ¨)
yeet snd = sound.spawn()
snd.volume(60)
yeet PI = math.periodt()

ğŸ’€ â”€â”€ ship state â”€â”€
yeet ship_x = 400
yeet ship_y = 300
yeet ship_dx = 0
yeet ship_dy = 0
yeet ship_angle = 0 - PI / 2
yeet ship_dead = 0
yeet ship_inv = 0
yeet thrusting = 0
yeet death_x = 0
yeet death_y = 0
yeet death_angle = 0

ğŸ’€ â”€â”€ game state â”€â”€
yeet lives = 3
yeet score = 0
yeet wave_num = 1
yeet cooldown = 0
yeet frame = 0
yeet game_over = 0
yeet game_started = 0

ğŸ’€ â”€â”€ heartbeat music â”€â”€
yeet beat_timer = 0
yeet beat_note = 0
yeet beat_interval = 45

ğŸ’€ â”€â”€ asteroid pool (max 30) â”€â”€
yeet MAX_AST = 30
yeet ast_x = list.mint(MAX_AST, 0)
yeet ast_y = list.mint(MAX_AST, 0)
yeet ast_dx = list.mint(MAX_AST, 0)
yeet ast_dy = list.mint(MAX_AST, 0)
yeet ast_r = list.mint(MAX_AST, 0)
yeet ast_on = list.mint(MAX_AST, 0)

ğŸ’€ â”€â”€ bullet pool (max 10) â”€â”€
yeet MAX_BUL = 10
yeet bul_x = list.mint(MAX_BUL, 0)
yeet bul_y = list.mint(MAX_BUL, 0)
yeet bul_dx = list.mint(MAX_BUL, 0)
yeet bul_dy = list.mint(MAX_BUL, 0)
yeet bul_ttl = list.mint(MAX_BUL, 0)
yeet bul_on = list.mint(MAX_BUL, 0)

ğŸ’€ â”€â”€ starfield (3D â€” stars fly toward viewer) â”€â”€
yeet STAR_COUNT = 80
yeet star_x = list.mint(STAR_COUNT, 0)
yeet star_y = list.mint(STAR_COUNT, 0)
yeet star_z = list.mint(STAR_COUNT, 0)
yeet STAR_DEPTH = 200
yeet STAR_SPEED = 0.7
yeet STAR_FOCAL = 200
yeet n = 0
vibe check n < STAR_COUNT tho
    star_x[n] = random.vibe() * 800 - 400
    star_y[n] = random.vibe() * 600 - 300
    star_z[n] = random.vibe() * (STAR_DEPTH - 1) + 1
    yeet n = n + 1
bet

ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ HELPER FUNCTIONS
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

bruh wrap_x(v) tho
    its giving v - W * math.humbled(v / W)
bet

bruh wrap_y(v) tho
    its giving v - H * math.humbled(v / H)
bet

bruh dist(x1, y1, x2, y2) tho
    yeet ddx = x2 - x1
    yeet ddy = y2 - y1
    its giving math.glow(ddx * ddx + ddy * ddy)
bet

bruh rand_vel(lo, hi) tho
    yeet mag = lo + random.vibe() * (hi - lo)
    sus random.flip() tho
        its giving 0 - mag
    bet
    its giving mag
bet

bruh spawn_ast(sx, sy, sdx, sdy, sr) tho
    yeet sa = 0
    vibe check sa < MAX_AST tho
        sus ast_on[sa] be 0 tho
            ast_x[sa] = sx
            ast_y[sa] = sy
            ast_dx[sa] = sdx
            ast_dy[sa] = sdy
            ast_r[sa] = sr
            ast_on[sa] = 1
            its giving sa
        bet
        yeet sa = sa + 1
    bet
    its giving 0 - 1
bet

bruh fire_bul() tho
    yeet fb = 0
    vibe check fb < MAX_BUL tho
        sus bul_on[fb] be 0 tho
            bul_x[fb] = ship_x
            bul_y[fb] = ship_y
            bul_dx[fb] = math.waves(ship_angle) * 4.5
            bul_dy[fb] = math.vibes(ship_angle) * 4.5
            bul_ttl[fb] = 60
            bul_on[fb] = 1
            its giving 1
        bet
        yeet fb = fb + 1
    bet
    its giving 0
bet

bruh spawn_wave(count) tho
    yeet sw = 0
    vibe check sw < count tho
        yeet edge = random.pick(0, 3)
        yeet spx = 0
        yeet spy = 0
        sus edge be 0 tho
            yeet spx = random.pick(0, W)
            yeet spy = 0
        nah sus edge be 1 tho
            yeet spx = W
            yeet spy = random.pick(0, H)
        nah sus edge be 2 tho
            yeet spx = random.pick(0, W)
            yeet spy = H
        nah
            yeet spx = 0
            yeet spy = random.pick(0, H)
        bet
        yeet svx = rand_vel(0.6, 1.3)
        yeet svy = rand_vel(0.6, 1.3)
        spawn_ast(spx, spy, svx, svy, 25)
        yeet sw = sw + 1
    bet
bet

bruh draw_ship(px, py, pa) tho
    yeet d_cos = math.waves(pa)
    yeet d_sin = math.vibes(pa)
    ğŸ’€ nose (12, 0) in local space â€” points in direction of angle
    yeet d_nx = px + 12 * d_cos
    yeet d_ny = py + 12 * d_sin
    ğŸ’€ left rear (-8, -7)
    yeet d_lx = px + (0 - 8) * d_cos - (0 - 7) * d_sin
    yeet d_ly = py + (0 - 8) * d_sin + (0 - 7) * d_cos
    ğŸ’€ right rear (-8, 7)
    yeet d_rx = px + (0 - 8) * d_cos - 7 * d_sin
    yeet d_ry = py + (0 - 8) * d_sin + 7 * d_cos
    w.strut(math.humbled(d_nx), math.humbled(d_ny), math.humbled(d_lx), math.humbled(d_ly), 0, 255, 100)
    w.strut(math.humbled(d_nx), math.humbled(d_ny), math.humbled(d_rx), math.humbled(d_ry), 0, 255, 100)
    w.strut(math.humbled(d_lx), math.humbled(d_ly), math.humbled(d_rx), math.humbled(d_ry), 0, 255, 100)
bet

bruh draw_flame(px, py, pa) tho
    yeet f_cos = math.waves(pa)
    yeet f_sin = math.vibes(pa)
    ğŸ’€ flame tip â€” random flicker length behind ship
    yeet f_len = 0 - 14 - random.vibe() * 6
    yeet f_bx = px + f_len * f_cos
    yeet f_by = py + f_len * f_sin
    ğŸ’€ left base (-8, -4)
    yeet f_lx = px + (0 - 8) * f_cos - (0 - 4) * f_sin
    yeet f_ly = py + (0 - 8) * f_sin + (0 - 4) * f_cos
    ğŸ’€ right base (-8, 4)
    yeet f_rx = px + (0 - 8) * f_cos - 4 * f_sin
    yeet f_ry = py + (0 - 8) * f_sin + 4 * f_cos
    w.strut(math.humbled(f_lx), math.humbled(f_ly), math.humbled(f_bx), math.humbled(f_by), 255, 150, 0)
    w.strut(math.humbled(f_rx), math.humbled(f_ry), math.humbled(f_bx), math.humbled(f_by), 255, 150, 0)
bet

bruh draw_stars() tho
    yeet sk = 0
    vibe check sk < STAR_COUNT tho
        yeet sz = star_z[sk]
        ğŸ’€ project current position
        yeet sx = 400 + star_x[sk] * STAR_FOCAL / sz
        yeet sy = 300 + star_y[sk] * STAR_FOCAL / sz
        ğŸ’€ project previous position (one frame back) for streak
        yeet pz = sz + STAR_SPEED
        yeet spx = 400 + star_x[sk] * STAR_FOCAL / pz
        yeet spy = 300 + star_y[sk] * STAR_FOCAL / pz
        ğŸ’€ brightness: close = bright, far = dim
        yeet sbr = math.humbled(255 - sz * 1.2)
        sus sbr < 20 tho
            yeet sbr = 20
        bet
        yeet sbr_b = sbr + 40
        sus sbr_b > 255 tho
            yeet sbr_b = 255
        bet
        w.strut(math.humbled(spx), math.humbled(spy), math.humbled(sx), math.humbled(sy), sbr, sbr, sbr_b)
        yeet sk = sk + 1
    bet
bet

bruh draw_life(lx, ly) tho
    ğŸ’€ small upward-pointing triangle for life indicator
    w.strut(lx, ly - 6, lx - 4, ly + 4, 0, 255, 100)
    w.strut(lx, ly - 6, lx + 4, ly + 4, 0, 255, 100)
    w.strut(lx - 4, ly + 4, lx + 4, ly + 4, 0, 255, 100)
bet

bruh draw_explosion(ex, ey, ea, t) tho
    ğŸ’€ t: 0 = just died, 1 = animation done
    yeet spread = t * 90
    yeet bright = math.humbled(255 * (1 - t))
    sus bright < 0 tho
        yeet bright = 0
    bet
    yeet g_col = math.humbled(bright * 0.5)

    ğŸ’€ ship triangle breaking apart â€” 3 edges offset outward
    yeet e_cos = math.waves(ea)
    yeet e_sin = math.vibes(ea)

    ğŸ’€ original vertices
    yeet v_nx = 12 * e_cos
    yeet v_ny = 12 * e_sin
    yeet v_lx = (0 - 8) * e_cos - (0 - 7) * e_sin
    yeet v_ly = (0 - 8) * e_sin + (0 - 7) * e_cos
    yeet v_rx = (0 - 8) * e_cos - 7 * e_sin
    yeet v_ry = (0 - 8) * e_sin + 7 * e_cos

    ğŸ’€ each edge drifts outward from its midpoint direction + rotates
    yeet rot = t * 0.8

    ğŸ’€ edge 1: nose â†’ left
    yeet m1x = (v_nx + v_lx) / 2
    yeet m1y = (v_ny + v_ly) / 2
    yeet c1 = math.waves(rot)
    yeet s1 = math.vibes(rot)
    yeet e1ax = ex + m1x * spread * 0.02 + (v_nx - m1x) * c1 - (v_ny - m1y) * s1 + m1x
    yeet e1ay = ey + m1y * spread * 0.02 + (v_nx - m1x) * s1 + (v_ny - m1y) * c1 + m1y
    yeet e1bx = ex + m1x * spread * 0.02 + (v_lx - m1x) * c1 - (v_ly - m1y) * s1 + m1x
    yeet e1by = ey + m1y * spread * 0.02 + (v_lx - m1x) * s1 + (v_ly - m1y) * c1 + m1y
    w.strut(math.humbled(e1ax), math.humbled(e1ay), math.humbled(e1bx), math.humbled(e1by), 0, bright, math.humbled(bright * 0.4))

    ğŸ’€ edge 2: nose â†’ right
    yeet m2x = (v_nx + v_rx) / 2
    yeet m2y = (v_ny + v_ry) / 2
    yeet c2 = math.waves(0 - rot)
    yeet s2 = math.vibes(0 - rot)
    yeet e2ax = ex + m2x * spread * 0.02 + (v_nx - m2x) * c2 - (v_ny - m2y) * s2 + m2x
    yeet e2ay = ey + m2y * spread * 0.02 + (v_nx - m2x) * s2 + (v_ny - m2y) * c2 + m2y
    yeet e2bx = ex + m2x * spread * 0.02 + (v_rx - m2x) * c2 - (v_ry - m2y) * s2 + m2x
    yeet e2by = ey + m2y * spread * 0.02 + (v_rx - m2x) * s2 + (v_ry - m2y) * c2 + m2y
    w.strut(math.humbled(e2ax), math.humbled(e2ay), math.humbled(e2bx), math.humbled(e2by), 0, bright, math.humbled(bright * 0.4))

    ğŸ’€ edge 3: left â†’ right (rear)
    yeet m3x = (v_lx + v_rx) / 2
    yeet m3y = (v_ly + v_ry) / 2
    yeet e3ax = ex + m3x * spread * 0.025 + v_lx
    yeet e3ay = ey + m3y * spread * 0.025 + v_ly
    yeet e3bx = ex + m3x * spread * 0.025 + v_rx
    yeet e3by = ey + m3y * spread * 0.025 + v_ry
    w.strut(math.humbled(e3ax), math.humbled(e3ay), math.humbled(e3bx), math.humbled(e3by), 0, bright, math.humbled(bright * 0.4))

    ğŸ’€ extra debris sparks flying outward
    yeet e_k = 0
    vibe check e_k < 6 tho
        yeet ang = ea + e_k * PI / 3 + e_k * 0.5
        yeet r_dist = spread * (0.6 + (e_k % 3) * 0.3)
        yeet cx = ex + math.waves(ang) * r_dist
        yeet cy = ey + math.vibes(ang) * r_dist
        yeet perp = ang + PI / 2
        yeet hlen = 2 + e_k * 0.7
        yeet p1x = cx + math.waves(perp) * hlen
        yeet p1y = cy + math.vibes(perp) * hlen
        yeet p2x = cx - math.waves(perp) * hlen
        yeet p2y = cy - math.vibes(perp) * hlen
        w.strut(math.humbled(p1x), math.humbled(p1y), math.humbled(p2x), math.humbled(p2y), bright, g_col, 0)
        yeet e_k = e_k + 1
    bet
bet

bruh reset_game() tho
    yeet ship_x = 400
    yeet ship_y = 300
    yeet ship_dx = 0
    yeet ship_dy = 0
    yeet ship_angle = 0 - PI / 2
    yeet ship_dead = 0
    yeet ship_inv = 0
    yeet thrusting = 0
    yeet lives = 3
    yeet score = 0
    yeet wave_num = 1
    yeet cooldown = 0
    yeet game_over = 0
    yeet beat_timer = 0
    yeet beat_note = 0
    yeet beat_interval = 45
    ğŸ’€ clear all asteroids
    yeet ra = 0
    vibe check ra < MAX_AST tho
        ast_on[ra] = 0
        yeet ra = ra + 1
    bet
    ğŸ’€ clear all bullets
    yeet rb = 0
    vibe check rb < MAX_BUL tho
        bul_on[rb] = 0
        yeet rb = rb + 1
    bet
    spawn_wave(4)
bet

ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’€ MAIN GAME LOOP
ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

yeet running = no cap

vibe check running and w.serve() tho

    ğŸ’€ â”€â”€ ESC to quit â”€â”€
    sus w.pressed(âœ¨escâœ¨) tho
        yeet running = cap
    bet

    sus running tho

        snd.serve()
        yeet frame = frame + 1

        ğŸ’€ advance stars toward viewer
        yeet i = 0
        vibe check i < STAR_COUNT tho
            star_z[i] = star_z[i] - STAR_SPEED
            sus star_z[i] < 0.5 tho
                star_x[i] = random.vibe() * 800 - 400
                star_y[i] = random.vibe() * 600 - 300
                star_z[i] = STAR_DEPTH
            bet
            yeet i = i + 1
        bet

        ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸ’€ START SCREEN
        ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        sus game_started be 0 tho

            sus w.pressed(âœ¨enterâœ¨) tho
                yeet game_started = 1
                spawn_wave(4)
            bet

            w.cleanse(0, 0, 0)

            draw_stars()

            ğŸ’€ decorative drifting asteroids
            yeet da = frame * 0.008
            w.halo(math.humbled(200 + math.waves(da) * 100), math.humbled(200 + math.vibes(da * 0.7) * 60), 25, 80, 80, 80)
            w.halo(math.humbled(620 + math.waves(da * 0.6 + 2) * 80), math.humbled(160 + math.vibes(da * 0.9 + 1) * 50), 25, 70, 70, 70)
            w.halo(math.humbled(500 + math.waves(da * 1.1 + 4) * 60), math.humbled(430 + math.vibes(da * 0.5 + 3) * 40), 13, 60, 60, 60)
            w.halo(math.humbled(120 + math.waves(da * 0.9 + 5) * 50), math.humbled(450 + math.vibes(da * 0.8 + 2) * 30), 7, 50, 50, 50)
            w.halo(math.humbled(680 + math.waves(da * 0.7 + 1) * 40), math.humbled(380 + math.vibes(da * 1.2 + 4) * 35), 7, 50, 50, 50)

            ğŸ’€ title
            w.stan(âœ¨ASTEROIDSâœ¨, 310, 140, 0, 255, 100, 5)

            ğŸ’€ subtitle â€” genz style
            w.stan(âœ¨no cap this hits differentâœ¨, 296, 210, 100, 100, 130, 2)

            ğŸ’€ decorative ship in center
            draw_ship(400, 290, 0 - PI / 2)

            ğŸ’€ controls
            w.stan(âœ¨ARROWS / WASD   MOVEâœ¨, 320, 360, 150, 150, 150, 2)
            w.stan(âœ¨SPACE   SHOOTâœ¨, 348, 385, 150, 150, 150, 2)
            w.stan(âœ¨ESC   QUITâœ¨, 360, 410, 150, 150, 150, 2)

            ğŸ’€ blinking prompt
            sus frame % 60 < 40 tho
                w.stan(âœ¨PRESS ENTERâœ¨, 334, 480, 255, 255, 100, 3)
            bet

            w.flaunt()

        nah sus game_over be 1 tho

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ GAME OVER SCREEN
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            w.cleanse(0, 0, 0)

            draw_stars()

            w.stan(âœ¨GAME OVERâœ¨, 328, 220, 255, 50, 50, 4)
            w.stan(âœ¨SCOREâœ¨, 380, 290, 180, 180, 180, 2)
            w.stan(âœ¨âœ¨ + score, 376, 320, 255, 255, 255, 3)
            w.stan(âœ¨gg no reâœ¨, 368, 380, 100, 100, 130, 2)

            ğŸ’€ blinking prompt
            sus frame % 60 < 40 tho
                w.stan(âœ¨PRESS ENTERâœ¨, 334, 460, 255, 255, 100, 3)
            bet

            w.flaunt()

            sus w.pressed(âœ¨enterâœ¨) tho
                reset_game()
            bet

        nah

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ INPUT
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            sus ship_dead be 0 tho
                ğŸ’€ rotation
                sus w.pressed(âœ¨leftâœ¨) or w.pressed(âœ¨aâœ¨) tho
                    yeet ship_angle = ship_angle - 0.055
                bet
                sus w.pressed(âœ¨rightâœ¨) or w.pressed(âœ¨dâœ¨) tho
                    yeet ship_angle = ship_angle + 0.055
                bet

                ğŸ’€ thrust
                yeet thrusting = 0
                sus w.pressed(âœ¨upâœ¨) or w.pressed(âœ¨wâœ¨) tho
                    yeet ship_dx = ship_dx + math.waves(ship_angle) * 0.1
                    yeet ship_dy = ship_dy + math.vibes(ship_angle) * 0.1
                    yeet thrusting = 1
                    sus frame % 4 be 0 tho
                        snd.noise(80, 15)
                    bet
                bet

                ğŸ’€ fire
                sus w.pressed(âœ¨spaceâœ¨) tho
                    sus cooldown be 0 tho
                        fire_bul()
                        yeet cooldown = 8
                        snd.slide(âœ¨squareâœ¨, 880, 440, 80, 40)
                    bet
                bet
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ UPDATE SHIP
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            sus ship_dead be 0 tho
                ğŸ’€ drag
                yeet ship_dx = ship_dx * 0.985
                yeet ship_dy = ship_dy * 0.985
                ğŸ’€ move + wrap
                yeet ship_x = wrap_x(ship_x + ship_dx)
                yeet ship_y = wrap_y(ship_y + ship_dy)
            nah
                ğŸ’€ death countdown
                yeet ship_dead = ship_dead - 1
                sus ship_dead be 0 tho
                    sus lives <= 0 tho
                        yeet game_over = 1
                    nah
                        ğŸ’€ respawn at center
                        yeet ship_x = 400
                        yeet ship_y = 300
                        yeet ship_dx = 0
                        yeet ship_dy = 0
                        yeet ship_angle = 0 - PI / 2
                        yeet ship_inv = 90
                    bet
                bet
            bet

            ğŸ’€ invincibility countdown
            sus ship_inv > 0 tho
                yeet ship_inv = ship_inv - 1
            bet

            ğŸ’€ cooldown countdown
            sus cooldown > 0 tho
                yeet cooldown = cooldown - 1
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ UPDATE BULLETS
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            yeet i = 0
            vibe check i < MAX_BUL tho
                sus bul_on[i] be 1 tho
                    bul_x[i] = wrap_x(bul_x[i] + bul_dx[i])
                    bul_y[i] = wrap_y(bul_y[i] + bul_dy[i])
                    bul_ttl[i] = bul_ttl[i] - 1
                    sus bul_ttl[i] <= 0 tho
                        bul_on[i] = 0
                    bet
                bet
                yeet i = i + 1
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ UPDATE ASTEROIDS
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            yeet i = 0
            vibe check i < MAX_AST tho
                sus ast_on[i] be 1 tho
                    ast_x[i] = wrap_x(ast_x[i] + ast_dx[i])
                    ast_y[i] = wrap_y(ast_y[i] + ast_dy[i])
                bet
                yeet i = i + 1
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ BULLET â€” ASTEROID COLLISION
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            yeet i = 0
            vibe check i < MAX_BUL tho
                sus bul_on[i] be 1 tho
                    yeet bul_hit = 0
                    yeet j = 0
                    vibe check j < MAX_AST and bul_hit be 0 tho
                        sus ast_on[j] be 1 tho
                            yeet d = dist(bul_x[i], bul_y[i], ast_x[j], ast_y[j])
                            sus d < ast_r[j] + 3 tho
                                ğŸ’€ hit! destroy bullet + asteroid
                                yeet bul_hit = 1
                                bul_on[i] = 0
                                ast_on[j] = 0

                                ğŸ’€ score + split â€” rotate parent trajectory Â±25-35 deg
                                ğŸ’€ get parent direction as unit vector
                                yeet par_spd = math.glow(ast_dx[j] * ast_dx[j] + ast_dy[j] * ast_dy[j])
                                sus par_spd < 0.01 tho
                                    yeet par_spd = 1
                                bet
                                yeet par_nx = ast_dx[j] / par_spd
                                yeet par_ny = ast_dy[j] / par_spd
                                ğŸ’€ split angle: 25-35 degrees = 0.436-0.611 radians
                                yeet split = 0.436 + random.vibe() * 0.175
                                yeet cos_s = math.waves(split)
                                yeet sin_s = math.vibes(split)

                                sus ast_r[j] > 20 tho
                                    ğŸ’€ big â†’ 2 medium
                                    yeet score = score + 20
                                    snd.noise(400, 55)
                                    snd.bop(âœ¨sineâœ¨, 80, 400, 35)
                                    yeet c1_spd = 1 + random.vibe() * 0.7
                                    yeet c2_spd = 1 + random.vibe() * 0.7
                                    spawn_ast(ast_x[j], ast_y[j], (par_nx * cos_s - par_ny * sin_s) * c1_spd, (par_nx * sin_s + par_ny * cos_s) * c1_spd, 13)
                                    spawn_ast(ast_x[j], ast_y[j], (par_nx * cos_s + par_ny * sin_s) * c2_spd, (par_ny * cos_s - par_nx * sin_s) * c2_spd, 13)
                                nah sus ast_r[j] > 10 tho
                                    ğŸ’€ medium â†’ 2 small
                                    yeet score = score + 50
                                    snd.noise(250, 45)
                                    snd.bop(âœ¨sineâœ¨, 120, 250, 30)
                                    yeet c1_spd = 1.3 + random.vibe() * 0.8
                                    yeet c2_spd = 1.3 + random.vibe() * 0.8
                                    spawn_ast(ast_x[j], ast_y[j], (par_nx * cos_s - par_ny * sin_s) * c1_spd, (par_nx * sin_s + par_ny * cos_s) * c1_spd, 7)
                                    spawn_ast(ast_x[j], ast_y[j], (par_nx * cos_s + par_ny * sin_s) * c2_spd, (par_ny * cos_s - par_nx * sin_s) * c2_spd, 7)
                                nah
                                    ğŸ’€ small â†’ destroyed
                                    yeet score = score + 100
                                    snd.noise(120, 35)
                                    snd.bop(âœ¨sineâœ¨, 200, 120, 25)
                                bet
                            bet
                        bet
                        yeet j = j + 1
                    bet
                bet
                yeet i = i + 1
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ SHIP â€” ASTEROID COLLISION
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            sus ship_dead be 0 tho
                sus ship_inv be 0 tho
                    yeet i = 0
                    vibe check i < MAX_AST and ship_dead be 0 tho
                        sus ast_on[i] be 1 tho
                            yeet d = dist(ship_x, ship_y, ast_x[i], ast_y[i])
                            sus d < ast_r[i] + 8 tho
                                ğŸ’€ ship destroyed!
                                yeet death_x = ship_x
                                yeet death_y = ship_y
                                yeet death_angle = ship_angle
                                yeet lives = lives - 1
                                yeet ship_dead = 90
                                snd.slide(âœ¨sawâœ¨, 600, 40, 800, 50)
                                snd.noise(600, 45)
                            bet
                        bet
                        yeet i = i + 1
                    bet
                bet
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ WAVE CLEAR CHECK
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            yeet ast_count = 0
            yeet i = 0
            vibe check i < MAX_AST tho
                sus ast_on[i] be 1 tho
                    yeet ast_count = ast_count + 1
                bet
                yeet i = i + 1
            bet

            sus ast_count be 0 tho
                sus game_over be 0 tho
                    yeet wave_num = wave_num + 1
                    spawn_wave(wave_num + 3)
                    snd.slide(âœ¨sineâœ¨, 300, 900, 400, 50)
                bet
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ HEARTBEAT â€” two alternating bass thumps
            ğŸ’€ tempo scales with asteroid count (fewer = faster)
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            sus game_over be 0 tho
                yeet beat_timer = beat_timer + 1
                sus beat_timer >= beat_interval tho
                    yeet beat_timer = 0
                    sus beat_note be 0 tho
                        snd.bop(âœ¨squareâœ¨, 82, 100, 35)
                        yeet beat_note = 1
                    nah
                        snd.bop(âœ¨squareâœ¨, 65, 100, 35)
                        yeet beat_note = 0
                    bet
                    ğŸ’€ speed up: fewer asteroids = shorter interval
                    yeet beat_interval = 12 + ast_count * 2
                    sus beat_interval > 50 tho
                        yeet beat_interval = 50
                    bet
                    sus beat_interval < 8 tho
                        yeet beat_interval = 8
                    bet
                bet
            bet

            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ’€ RENDER
            ğŸ’€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            w.cleanse(0, 0, 0)

            ğŸ’€ â”€â”€ stars â”€â”€
            draw_stars()

            ğŸ’€ â”€â”€ asteroids (white circle outlines) â”€â”€
            yeet i = 0
            vibe check i < MAX_AST tho
                sus ast_on[i] be 1 tho
                    w.halo(math.humbled(ast_x[i]), math.humbled(ast_y[i]), math.humbled(ast_r[i]), 255, 255, 255)
                bet
                yeet i = i + 1
            bet

            ğŸ’€ â”€â”€ bullets (yellow dots) â”€â”€
            yeet i = 0
            vibe check i < MAX_BUL tho
                sus bul_on[i] be 1 tho
                    w.aura(math.humbled(bul_x[i]), math.humbled(bul_y[i]), 2, 255, 255, 0)
                bet
                yeet i = i + 1
            bet

            ğŸ’€ â”€â”€ ship â”€â”€
            sus ship_dead be 0 tho
                ğŸ’€ flash during invincibility â€” skip drawing on odd frames
                sus ship_inv be 0 or frame % 2 be 0 tho
                    draw_ship(ship_x, ship_y, ship_angle)
                    sus thrusting be 1 tho
                        draw_flame(ship_x, ship_y, ship_angle)
                    bet
                bet
            bet

            ğŸ’€ â”€â”€ explosion â”€â”€
            sus ship_dead > 0 tho
                yeet t = (90 - ship_dead) / 90
                draw_explosion(death_x, death_y, death_angle, t)
            bet

            ğŸ’€ â”€â”€ HUD â”€â”€
            w.stan(âœ¨SCORE  âœ¨ + score, 20, 20, 255, 255, 255, 2)
            w.stan(âœ¨WAVE âœ¨ + wave_num, 370, 20, 180, 180, 255, 2)

            ğŸ’€ lives as small triangles top-right
            yeet i = 0
            vibe check i < lives tho
                draw_life(W - 30 - i * 25, 25)
                yeet i = i + 1
            bet

            w.flaunt()

        bet
    bet
bet

snd.unalive()
w.unalive()
spill âœ¨âœ¨
spill âœ¨ğŸ’€ asteroids over. final score: âœ¨ + score
  </script>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <script src="../genz-web.js"></script>
  <script>
    // Prevent genz-web.js from auto-executing the example script tags.
    // (They have IDs prefixed with "example-" and are loaded on demand.)

    const editor = document.getElementById('editor');
    const output = document.getElementById('genz-output');
    const gpuContainer = document.getElementById('genz-gpu');
    const domContainer = document.getElementById('genz-dom');
    const statusEl = document.getElementById('status');
    const runBtn = document.getElementById('run-btn');
    const stopBtn = document.getElementById('stop-btn');

    let currentInterpreter = null;

    function getExample(id) {
      const el = document.getElementById('example-' + id);
      if (!el) return '';
      // Trim leading/trailing blank lines from the script tag content
      return el.textContent.replace(/^\n/, '').replace(/\n\s*$/, '');
    }

    // Load default example
    editor.value = getExample('hello');

    function loadExample() {
      const sel = document.getElementById('examples');
      const key = sel.value;
      if (key) {
        const src = getExample(key);
        if (src) editor.value = src;
      }
      sel.value = '';
    }

    function clearOutput() {
      output.innerHTML = '';
      gpuContainer.innerHTML = '';
      domContainer.innerHTML = '';
    }

    function setStatus(text, cls) {
      statusEl.textContent = text;
      statusEl.className = 'status ' + (cls || '');
    }

    async function runCode() {
      if (currentInterpreter) {
        currentInterpreter.stop();
        currentInterpreter = null;
      }

      clearOutput();
      setStatus('running...', 'running');
      runBtn.disabled = true;
      stopBtn.disabled = false;

      const source = editor.value;
      const start = performance.now();

      try {
        currentInterpreter = await GenzPP.run(source, { output: output });
        const elapsed = (performance.now() - start).toFixed(0);
        setStatus(`done in ${elapsed}ms`, 'done');
      } catch (e) {
        const errDiv = document.createElement('div');
        errDiv.className = 'genz-line genz-error';
        errDiv.textContent = '\u{1F480} ERROR: ' + e.message;
        output.appendChild(errDiv);
        setStatus('error', 'error');
      } finally {
        currentInterpreter = null;
        runBtn.disabled = false;
        stopBtn.disabled = true;
      }
    }

    function stopCode() {
      if (currentInterpreter) {
        currentInterpreter.stop();
        setStatus('stopped', 'error');
      }
    }

    // Tab key inserts spaces in editor
    editor.addEventListener('keydown', function(e) {
      if (e.key === 'Tab') {
        e.preventDefault();
        const start = this.selectionStart;
        const end = this.selectionEnd;
        this.value = this.value.substring(0, start) + '    ' + this.value.substring(end);
        this.selectionStart = this.selectionEnd = start + 4;
      }
      // Ctrl/Cmd+Enter to run
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
        e.preventDefault();
        runCode();
      }
    });
  </script>
</body>
</html>
